# 10. Excel 수식 전체 목록 및 분류

## 📊 분석 개요

**파일명**: 20191206_CNU_CNM_v2.17.xlsm  
**분석 결과**: 27,061개 수식, 141,719개 상수  
**생성일**: 2024년

## 📋 워크시트별 수식 분포

### 1. 핵심 계산 시트 (높은 수식 밀도)

#### 반추위 모델 (13,908개 수식)
- **비중**: 전체의 51.4%
- **특징**: 가장 복잡한 계산 모델
- **주요 기능**: 
  - 사료 발효 계산
  - 미생물 단백질 생산
  - VFA 생산 및 흡수
  - pH 및 온도 영향

#### 소장 모델 (9,166개 수식)
- **비중**: 전체의 33.9%
- **특징**: 두 번째로 복잡한 모델
- **주요 기능**:
  - 영양소 흡수율 계산
  - 소화율 계산
  - 아미노산 흡수
  - 지방 흡수

#### 한국사료라이브러리 (1,332개 수식)
- **비중**: 전체의 4.9%
- **특징**: 사료 데이터 처리
- **주요 기능**:
  - 사료 성분 계산
  - 영양소 변환
  - 데이터 검증

### 2. 최적화 및 시뮬레이션 시트

#### Optimizer (652개 수식)
- **비중**: 전체의 2.4%
- **특징**: 사료 배합 최적화
- **주요 기능**:
  - 목적 함수 설정
  - 제약 조건 관리
  - 최적 해 계산
  - 비용 최소화

#### Growth_Simul (316개 수식)
- **비중**: 전체의 1.2%
- **특징**: 성장 시뮬레이션
- **주요 기능**:
  - 성장 곡선 모델링
  - 체중 변화 예측
  - 영양 요구량 변화

#### 급여프로그램평가 (190개 수식)
- **비중**: 전체의 0.7%
- **특징**: 급여 프로그램 분석
- **주요 기능**:
  - 프로그램 효율성 평가
  - 비용 분석
  - 성과 측정

### 3. 동물별 계산 시트

#### 육성 비육우 (293개 수식)
- **비중**: 전체의 1.1%
- **특징**: 육성기 비육우 전용
- **주요 기능**:
  - 성장 요구량 계산
  - 사료 효율성 분석
  - 경제성 평가

#### 비유우 1.0 (283개 수식)
- **비중**: 전체의 1.0%
- **특징**: 비유우 전용 계산
- **주요 기능**:
  - 유산 요구량 계산
  - 유량 예측
  - 영양 밸런스 분석

#### 건유우 1.0 (282개 수식)
- **비중**: 전체의 1.0%
- **특징**: 건유우 전용 계산
- **주요 기능**:
  - 유지 요구량 계산
  - 태아 발육 요구량
  - 체지방 축적

#### 처녀우 1.0 (284개 수식)
- **비중**: 전체의 1.0%
- **특징**: 처녀우 전용 계산
- **주요 기능**:
  - 성장 요구량 계산
  - 번식 요구량
  - 체중 증가 예측

### 4. 영양 요구량 계산 시트

#### 유지 요구량 (60개 수식)
- **비중**: 전체의 0.2%
- **특징**: 기본 유지 요구량
- **주요 기능**:
  - FHP 계산
  - 활동 에너지
  - 체온 조절

#### 성장_임신 요구량 (41개 수식)
- **비중**: 전체의 0.2%
- **특징**: 성장 및 임신 요구량
- **주요 기능**:
  - 성장 에너지 계산
  - 임신 에너지 계산
  - 단백질 요구량

#### 비유 요구량 (21개 수식)
- **비중**: 전체의 0.1%
- **특징**: 유산 요구량
- **주요 기능**:
  - 우유 에너지 계산
  - 우유 단백질 계산
  - 유량별 요구량

#### 아미노산 요구량 (66개 수식)
- **비중**: 전체의 0.2%
- **특징**: 아미노산별 요구량
- **주요 기능**:
  - 필수 아미노산 계산
  - 제한 아미노산 분석
  - 아미노산 밸런스

#### 체 축적량 (34개 수식)
- **비중**: 전체의 0.1%
- **특징**: 체지방 축적 계산
- **주요 기능**:
  - 체지방 축적량
  - 에너지 축적
  - 체중 증가 분석

#### 섭취량 예측 (30개 수식)
- **비중**: 전체의 0.1%
- **특징**: 건물 섭취량 예측
- **주요 기능**:
  - 체중 기반 예측
  - 생산성 조정
  - 환경 영향

#### 광물질 요구량 (17개 수식)
- **비중**: 전체의 0.1%
- **특징**: 미네랄 요구량
- **주요 기능**:
  - 주요 미네랄 계산
  - 미량 미네랄 계산
  - 흡수율 고려

#### 생산량 예측 (47개 수식)
- **비중**: 전체의 0.2%
- **특징**: 생산성 예측
- **주요 기능**:
  - 유량 예측
  - 유지방 예측
  - 유단백 예측

### 5. 데이터 및 설정 시트

#### input (19개 수식)
- **비중**: 전체의 0.1%
- **특징**: 기본 입력 데이터
- **주요 기능**:
  - 동물 정보 입력
  - 기본 변환 계산
  - 설정값 관리

#### 품종테이블 (4개 수식)
- **비중**: 전체의 0.01%
- **특징**: 품종별 특성
- **주요 기능**:
  - 품종별 계수
  - 성숙 체중
  - 특성 데이터

#### PalisadeFitLinks (3개 수식)
- **비중**: 전체의 0.01%
- **특징**: 최적화 엔진 연동
- **주요 기능**:
  - Palisade 엔진 호출
  - 최적화 파라미터
  - 결과 연동

#### ev_HiddenInfo (13개 수식)
- **비중**: 전체의 0.05%
- **특징**: 숨겨진 정보
- **주요 기능**:
  - 시스템 정보
  - 버전 정보
  - 설정 정보

### 6. 데이터 전용 시트 (수식 없음)

- **CNCPS 사료라이브러리**: 순수 데이터
- **퓨리나 사료**: 순수 데이터
- **updates**: 업데이트 정보
- **_PalUtilTempWorksheet**: 임시 워크시트

## 🔍 수식 유형별 분석

### 1. 조건부 계산 (IF 함수)
- **비중**: 전체의 30%
- **주요 용도**:
  - 품종별 계산 분기
  - 생리적 단계별 분기
  - 오류 처리
  - 조건부 표시

### 2. 데이터 조회 (VLOOKUP)
- **비중**: 전체의 1.2%
- **주요 용도**:
  - 품종 정보 조회
  - 사료 성분 조회
  - 계수 테이블 조회
  - 설정값 조회

### 3. 수학적 계산
- **거듭제곱 (POWER)**: 657개
- **반올림 (ROUND)**: 810개
- **로그 (LOGARITHM)**: 2개
- **최대/최소 (MAX/MIN)**: 667개

### 4. 통계 함수
- **합계 (SUM)**: 716개
- **평균 (AVERAGE)**: 66개
- **개수 (COUNT)**: 기타

## 🧮 핵심 수식 패턴

### 1. 체중 변환 패턴
```excel
// FBW → SBW 변환
=FBW*0.96

// MW → SBW 변환  
=MW*0.96

// 목표 체중 계산
=(현재체중+(현재체중+목표ADG*30.4*기간))/2
```

### 2. 영양소 변환 패턴
```excel
// MCP → MP 변환
=MkCP*0.93

// 단백질 효율성
=단백질함량*효율성계수
```

### 3. 조건부 계산 패턴
```excel
// 품종별 분기
=IF(Breed_type=3,"유우 단위","육우 단위")

// BCS 변환
=IF(Breed_type=3,BCS*2-1,BCS)
```

### 4. 데이터 조회 패턴
```excel
// 품종 정보 조회
=VLOOKUP(C4,breed_table,2)

// 활동 계수 조회
=VLOOKUP(E$89,activity_table,3,TRUE)
```

## 📊 복잡도 분석

### 높은 복잡도 시트 (1,000개 이상 수식)
1. **반추위 모델**: 13,908개 - 가장 복잡
2. **소장 모델**: 9,166개 - 두 번째 복잡
3. **한국사료라이브러리**: 1,332개 - 데이터 처리

### 중간 복잡도 시트 (100-1,000개 수식)
1. **Optimizer**: 652개 - 최적화
2. **Growth_Simul**: 316개 - 시뮬레이션
3. **육성 비육우**: 293개 - 동물별 계산
4. **비유우/건유우/처녀우**: 각 280-290개

### 낮은 복잡도 시트 (100개 미만 수식)
- 영양 요구량 계산 시트들
- 입력 및 설정 시트들

## 🔧 구현 고려사항

### 1. Python 변환 우선순위
1. **높은 우선순위**: 반추위 모델, 소장 모델
2. **중간 우선순위**: Optimizer, 동물별 계산
3. **낮은 우선순위**: 영양 요구량, 데이터 처리

### 2. 마이크로서비스 분리 기준
- **반추위 서비스**: 반추위 모델 전담
- **소장 서비스**: 소장 모델 전담
- **최적화 서비스**: Optimizer 전담
- **동물별 서비스**: 동물별 계산 전담

### 3. 데이터베이스 설계
- **테이블 기반 계산**: VLOOKUP → 데이터베이스 쿼리
- **계수 관리**: 상수 테이블화
- **설정 관리**: 설정 테이블화

### 4. 성능 최적화
- **반복 계산**: 효율적인 알고리즘으로 개선
- **조건부 계산**: 캐싱 및 최적화
- **대량 계산**: 벡터화 연산 활용

---

## 📋 결론

이 Excel 파일은 **27,061개의 수식**으로 구성된 매우 복잡한 영양 계산 시스템입니다. 특히 **반추위 모델(51.4%)**과 **소장 모델(33.9%)**이 전체 복잡도의 85%를 차지하며, 이는 Python 기반 마이크로서비스 구현 시 가장 중요한 핵심 모듈이 될 것입니다.

**조건부 계산(30%)**이 높은 비중을 차지하는 것은 품종별, 생리적 단계별로 다른 계산 로직을 적용하는 복잡한 영양 모델임을 보여줍니다.

---

*이 문서는 Excel 파일의 모든 수식을 체계적으로 분석하여 Python 기반 마이크로서비스 구현을 위한 완전한 가이드를 제공합니다.*
