# 8. CNUCNM 전체 작업 프로세스 순서도

## 📋 개요

이 문서는 CNUCNM 시스템의 전체 작업 프로세스를 순서도(Flowchart) 형태로 정리한 것입니다. 사용자 입력부터 최종 결과 출력까지의 모든 단계를 시각적으로 표현하여 시스템의 전체적인 흐름을 이해할 수 있도록 구성했습니다.

## 🔄 전체 시스템 프로세스 순서도

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           CNUCNM 시스템 시작                                │
└─────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        1. 사용자 인증 및 권한 확인                          │
├─────────────────────────────────────────────────────────────────────────────┤
│  • 로그인/회원가입                                                          │
│  • JWT 토큰 검증                                                            │
│  • 역할 기반 권한 확인 (농장주, 수의사, 관리자)                            │
└─────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        2. 동물 정보 입력 및 관리                            │
├─────────────────────────────────────────────────────────────────────────────┤
│  • 동물 기본 정보 등록 (품종, 체중, 연령, 성별)                            │
│  • 생리적 단계 설정 (송아지/성장기/유우/건유기)                            │
│  • 생산성 정보 입력 (유량, 유지방, 유단백)                                 │
│  • 번식 정보 입력 (임신일수, 목표 증체량)                                  │
└─────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        3. 체중 변환 및 계산 준비                            │
├─────────────────────────────────────────────────────────────────────────────┤
│  • FBW → SBW 변환 (× 0.96)                                                │
│  • SBW → EBW 변환 (× 0.891)                                               │
│  • ADG → EWG 변환 (× 0.956)                                               │
│  • 기본 상수 및 계수 로드                                                  │
└─────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        4. 영양 요구량 계산 (NASEM 2024)                     │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐         │
│  │   유지 요구량    │    │   성장 요구량    │    │   번식 요구량    │         │
│  │   계산          │    │   계산          │    │   계산          │         │
│  │                 │    │                 │    │                 │         │
│  │ • FHP 계산      │    │ • 성장 에너지   │    │ • 임신 에너지   │         │
│  │ • 활동 에너지   │    │ • 성장 단백질   │    │ • 임신 단백질   │         │
│  │ • 유지 단백질   │    │                 │    │                 │         │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘         │
│           │                       │                       │                 │
│           └───────────────────────┼───────────────────────┘                 │
│                                   ▼                                         │
│  ┌─────────────────┐    ┌─────────────────┐                                │
│  │   유산 요구량    │    │   총 요구량      │                                │
│  │   계산          │    │   합산          │                                │
│  │                 │    │                 │                                │
│  │ • 유산 에너지   │    │ • 총 에너지     │                                │
│  │ • 유산 단백질   │    │ • 총 단백질     │                                │
│  └─────────────────┘    └─────────────────┘                                │
└─────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        5. 환경 요인 보정                                    │
├─────────────────────────────────────────────────────────────────────────────┤
│  • 온도 보정 (저온/고온 스트레스)                                          │
│  • 습도 보정                                                                 │
│  • 활동량 보정                                                              │
│  • 품종별 특성 보정                                                        │
└─────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        6. 섭취량 예측                                      │
├─────────────────────────────────────────────────────────────────────────────┤
│  • 체중 기반 기본 섭취량 예측                                              │
│  • 생산성 기반 섭취량 조정                                                 │
│  • 환경 요인에 따른 섭취량 보정                                            │
│  • 개체별 차이 보정                                                        │
└─────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        7. 사료 라이브러리 검색                              │
├─────────────────────────────────────────────────────────────────────────────┤
│  • 사용 가능한 사료 목록 조회 (984개 사료)                                 │
│  • 영양성분별 필터링                                                       │
│  • 가격 정보 확인                                                          │
│  • 사용자 정의 사료 추가                                                   │
└─────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        8. 사료 배합 최적화 (선형계획법)                     │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐         │
│  │   목적 함수      │    │   제약 조건      │    │   최적화        │         │
│  │   설정          │    │   설정          │    │   실행          │         │
│  │                 │    │                 │    │                 │         │
│  │ • 비용 최소화   │    │ • 영양소 제약   │    │ • PuLP 솔버    │         │
│  │ • 다중 목표     │    │ • 사료 비율 제약│    │ • 최적해 탐색   │         │
│  │   최적화        │    │ • 총량 제약     │    │ • 결과 검증     │         │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘         │
│           │                       │                       │                 │
│           └───────────────────────┼───────────────────────┘                 │
│                                   ▼                                         │
│  ┌─────────────────┐    ┌─────────────────┐                                │
│  │   결과 분석      │    │   대안 제시      │                                │
│  │                 │    │                 │                                │
│  │ • 최적 배합     │    │ • 비용 민감도   │                                │
│  │ • 영양소 조성   │    │ • 대안 배합     │                                │
│  │ • 총 비용       │    │ • 위험 분석     │                                │
│  └─────────────────┘    └─────────────────┘                                │
└─────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        9. 영양 분석 및 진단                                │
├─────────────────────────────────────────────────────────────────────────────┤
│  • 영양소 함량 계산                                                        │
│  • 영양소 비율 분석 (CP:NDF, Ca:P 등)                                     │
│  • 균형 점수 계산                                                          │
│  • 부족/과잉 영양소 진단                                                   │
│  • 개선 방안 제안                                                          │
└─────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        10. 결과 검증 및 품질 관리                           │
├─────────────────────────────────────────────────────────────────────────────┤
│  • 계산 결과 범위 검증                                                     │
│  • 영양소 균형 검증                                                        │
│  • 비용 효율성 검증                                                        │
│  • 오류 및 경고 메시지 생성                                                │
└─────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        11. 보고서 생성                                     │
├─────────────────────────────────────────────────────────────────────────────┤
│  • 영양 분석 리포트 (PDF)                                                  │
│  • 배합 최적화 리포트                                                      │
│  • 경제성 분석 리포트                                                      │
│  • Excel 데이터 내보내기                                                  │
│  • 차트 및 그래프 생성                                                     │
└─────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        12. 알림 및 모니터링                                │
├─────────────────────────────────────────────────────────────────────────────┤
│  • 영양소 과부족 알림                                                      │
│  • 비용 초과 알림                                                          │
│  • 시스템 성능 모니터링                                                    │
│  • 사용 패턴 분석                                                          │
└─────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        13. 데이터 저장 및 이력 관리                         │
├─────────────────────────────────────────────────────────────────────────────┤
│  • 계산 결과 데이터베이스 저장                                             │
│  • 사용 이력 기록                                                          │
│  • 데이터 백업                                                             │
│  • 버전 관리                                                               │
└─────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                           시스템 종료                                      │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 🔄 상세 프로세스 순서도

### 4. 영양 요구량 계산 상세 프로세스

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        영양 요구량 계산 시작                                │
└─────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        4.1 유지 요구량 계산                                 │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐         │
│  │   FHP 계산      │    │   활동 에너지    │    │   유지 단백질    │         │
│  │                 │    │   계산          │    │   계산          │         │
│  │ • 품종별 계수   │    │ • 활동 수준     │    │ • 내인성 요실   │         │
│  │ • EBW^0.75     │    │ • EBW^0.75     │    │ • 대사성 요실   │         │
│  │ • 생리적 단계   │    │ • 보정 계수     │    │ • DMI 기반      │         │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘         │
│           │                       │                       │                 │
│           └───────────────────────┼───────────────────────┘                 │
│                                   ▼                                         │
│  ┌─────────────────┐    ┌─────────────────┐                                │
│  │   총 유지 요구량  │    │   다음 단계      │                                │
│  │   합산          │    │   진행          │                                │
│  │                 │    │                 │                                │
│  │ • 유지 에너지   │    │ • 성장 요구량   │                                │
│  │ • 유지 단백질   │    │ • 번식 요구량   │                                │
│  └─────────────────┘    └─────────────────┘                                │
└─────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        4.2 성장 요구량 계산                                 │
├─────────────────────────────────────────────────────────────────────────────┤
│  • EWG 기반 성장 에너지 계산                                               │
│  • 품종별 성장 단백질 계수 적용                                            │
│  • 체중별 성장 효율성 고려                                                 │
└─────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        4.3 번식 요구량 계산                                 │
├─────────────────────────────────────────────────────────────────────────────┤
│  • 임신일수 기반 임신 에너지 계산                                          │
│  • 임신일수^2 비례 임신 단백질 계산                                        │
│  • 품종별 번식 특성 반영                                                   │
└─────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        4.4 유산 요구량 계산                                 │
├─────────────────────────────────────────────────────────────────────────────┤
│  • 유량 × 유에너지 함량 = 유산 에너지                                      │
│  • 유량 × 유단백 함량 = 유산 단백질                                        │
│  • 유지방, 유단백 함량에 따른 보정                                         │
└─────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        4.5 총 요구량 합산                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│  • 유지 + 성장 + 번식 + 유산 = 총 에너지 요구량                             │
│  • 유지 + 성장 + 번식 + 유산 = 총 단백질 요구량                             │
│  • 각 구성 요소별 상세 내역 제공                                           │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 8. 사료 배합 최적화 상세 프로세스

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        사료 배합 최적화 시작                                │
└─────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        8.1 문제 정의                                       │
├─────────────────────────────────────────────────────────────────────────────┤
│  • 결정 변수: 각 사료의 사용량 (kg)                                        │
│  • 목적 함수: 총 비용 최소화                                               │
│  • 제약 조건: 영양소 요구량, 사료 비율, 총량                               │
└─────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        8.2 제약 조건 설정                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐         │
│  │   영양소 제약   │    │   비율 제약     │    │   총량 제약     │         │
│  │                 │    │                 │    │                 │         │
│  │ • CP 최소/최대  │    │ • 사료별 최소   │    │ • 총 DMI = 목표 │         │
│  │ • 에너지 최소/  │    │   비율          │    │   DMI           │         │
│  │   최대          │    │ • 사료별 최대   │    │                 │         │
│  │ • NDF 최소/최대 │    │   비율          │    │                 │         │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘         │
└─────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        8.3 최적화 실행                                     │
├─────────────────────────────────────────────────────────────────────────────┤
│  • PuLP 라이브러리 사용                                                    │
│  • Simplex 알고리즘 실행                                                   │
│  • 최적해 탐색                                                             │
│  • 수렴성 확인                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        8.4 결과 분석                                       │
├─────────────────────────────────────────────────────────────────────────────┤
│  • 최적 배합 비율 계산                                                     │
│  • 영양소 조성 계산                                                        │
│  • 총 비용 계산                                                            │
│  • 제약 조건 만족도 확인                                                   │
└─────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        8.5 대안 분석                                       │
├─────────────────────────────────────────────────────────────────────────────┤
│  • 비용 민감도 분석                                                        │
│  • 영양소 민감도 분석                                                      │
│  • 대안 배합 생성                                                          │
│  • 위험 요소 평가                                                          │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 🔄 에러 처리 및 예외 상황 프로세스

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        에러 상황 발생                                       │
└─────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        에러 유형 분류                                       │
├─────────────────────────────────────────────────────────────────────────────┤
│  • 입력 데이터 오류                                                        │
│  • 계산 오류                                                               │
│  • 최적화 실패                                                             │
│  • 시스템 오류                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        에러 처리 프로세스                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐         │
│  │   입력 검증     │    │   계산 검증     │    │   최적화 검증   │         │
│  │                 │    │                 │    │                 │         │
│  │ • 데이터 범위   │    │ • 수학적 오류   │    │ • 제약 조건     │         │
│  │   확인          │    │   확인          │    │   충돌 확인     │         │
│  │ • 필수 항목     │    │ • 0으로 나누기  │    │ • 실행 가능성   │         │
│  │   확인          │    │   방지          │    │   확인          │         │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘         │
│           │                       │                       │                 │
│           └───────────────────────┼───────────────────────┘                 │
│                                   ▼                                         │
│  ┌─────────────────┐    ┌─────────────────┐                                │
│  │   오류 메시지   │    │   복구 방안     │                                │
│  │   생성          │    │   제시          │                                │
│  │                 │    │                 │                                │
│  │ • 사용자 친화적 │    │ • 자동 복구     │                                │
│  │   메시지        │    │ • 수동 조정     │                                │
│  │ • 오류 코드     │    │ • 대안 제시     │                                │
│  └─────────────────┘    └─────────────────┘                                │
└─────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        로그 기록 및 모니터링                                │
├─────────────────────────────────────────────────────────────────────────────┤
│  • 오류 로그 저장                                                           │
│  • 사용자 행동 추적                                                        │
│  • 시스템 성능 모니터링                                                    │
│  • 알림 발송                                                               │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 🔄 데이터 흐름 다이어그램

```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   사용자    │───▶│   API       │───▶│   인증      │───▶│   권한      │
│   입력      │    │   Gateway   │    │   서비스    │    │   확인      │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
                                                           │
                                                           ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   동물      │◀───│   동물      │◀───│   사용자    │◀───│   사용자    │
│   정보      │    │   관리      │    │   관리      │    │   정보      │
│   데이터베이스│    │   서비스    │    │   서비스    │    │   데이터베이스│
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
        │                   │                   │                   │
        ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   영양      │    │   사료      │    │   계산      │    │   결과      │
│   계산      │    │   라이브러리│    │   엔진      │    │   저장      │
│   서비스    │    │   서비스    │    │             │    │   서비스    │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
        │                   │                   │                   │
        ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   배합      │    │   분석      │    │   보고서    │    │   알림      │
│   최적화    │    │   서비스    │    │   생성      │    │   서비스    │
│   서비스    │    │             │    │   서비스    │    │             │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
        │                   │                   │                   │
        ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   결과      │    │   모니터링  │    │   사용자    │    │   시스템    │
│   출력      │    │   서비스    │    │   인터페이스│    │   종료      │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
```

## 📊 성능 지표 및 모니터링 포인트

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        성능 모니터링 포인트                                 │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐         │
│  │   응답 시간     │    │   처리량        │    │   오류율        │         │
│  │   모니터링      │    │   모니터링      │    │   모니터링      │         │
│  │                 │    │                 │    │                 │         │
│  │ • API 응답 시간 │    │ • 초당 요청 수  │    │ • 오류 발생률   │         │
│  │ • 계산 시간     │    │ • 동시 사용자   │    │ • 타임아웃     │         │
│  │ • 데이터베이스  │    │ • 리소스 사용률 │    │ • 메모리 부족   │         │
│  │   쿼리 시간     │    │                 │    │                 │         │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘         │
│           │                       │                       │                 │
│           └───────────────────────┼───────────────────────┘                 │
│                                   ▼                                         │
│  ┌─────────────────┐    ┌─────────────────┐                                │
│  │   가용성        │    │   사용자        │                                │
│  │   모니터링      │    │   경험          │                                │
│  │                 │    │   모니터링      │                                │
│  │ • 서비스 가용성 │    │ • 사용자 만족도 │                                │
│  │ • 장애 복구     │    │ • 기능 사용률   │                                │
│  │ • 백업 상태     │    │ • 성능 지표     │                                │
│  └─────────────────┘    └─────────────────┘                                │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

*이 문서는 CNUCNM 시스템의 전체 작업 프로세스를 순서도 형태로 정리한 것으로, 시스템의 전체적인 흐름과 각 단계별 상세 프로세스를 이해할 수 있도록 구성되었습니다.*
