<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CNUCNM ê³µì‹ ë„¤íŠ¸ì›Œí¬ - Excel ìˆ˜ì‹ ì˜ì¡´ì„± ë¶„ì„</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255,255,255,0.95);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            text-align: center;
        }

        .header h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 1.1em;
        }

        .controls {
            background: rgba(255,255,255,0.95);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .control-group {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .control-group label {
            font-weight: bold;
            color: #667eea;
            min-width: 120px;
        }

        .control-group select, .control-group input {
            padding: 8px 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 14px;
            min-width: 150px;
        }

        .control-group button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .control-group button:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
        }

        .export-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .export-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .export-btn:hover {
            background: #218838;
            transform: translateY(-1px);
        }

        .network-container {
            background: rgba(255,255,255,0.95);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .network-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .info-item {
            text-align: center;
        }

        .info-item h4 {
            color: #667eea;
            margin-bottom: 5px;
        }

        .info-item p {
            font-size: 1.2em;
            font-weight: bold;
            color: #333;
        }

        #network-graph {
            width: 100%;
            height: 700px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            background: white;
            overflow: hidden;
            position: relative;
        }

        .zoom-controls {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255,255,255,0.9);
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
        }

        .zoom-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 12px;
            margin: 2px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .zoom-btn:hover {
            background: #5a6fd8;
        }

        .formula-details {
            background: rgba(255,255,255,0.95);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .formula-details h3 {
            color: #667eea;
            margin-bottom: 20px;
            text-align: center;
        }

        .formula-categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .formula-category {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .formula-category h4 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .formula-list {
            list-style: none;
        }

        .formula-item {
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
        }

        .tooltip {
            position: absolute;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-size: 12px;
            pointer-events: none;
            z-index: 1000;
        }

        .loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255,255,255,0.95);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
            z-index: 2000;
            text-align: center;
        }

        .loading h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ”¬ CNUCNM ê³µì‹ ë„¤íŠ¸ì›Œí¬ ë¶„ì„</h1>
            <p>Excel íŒŒì¼ì˜ 27,061ê°œ ìˆ˜ì‹ ì˜ì¡´ì„± ê´€ê³„ ì‹œê°í™” ë° ë¶„ì„</p>
        </div>

        <div class="controls">
            <div class="control-group">
                <label>ì¹´í…Œê³ ë¦¬ í•„í„°:</label>
                <select id="category-filter">
                    <option value="all">ì „ì²´</option>
                    <option value="body-weight">ì²´ì¤‘ ê³„ì‚°</option>
                    <option value="energy">ì—ë„ˆì§€ ìš”êµ¬ëŸ‰</option>
                    <option value="protein">ë‹¨ë°±ì§ˆ ìš”êµ¬ëŸ‰</option>
                    <option value="amino-acid">ì•„ë¯¸ë…¸ì‚°</option>
                    <option value="intake">ì„­ì·¨ëŸ‰ ì˜ˆì¸¡</option>
                    <option value="optimization">ìµœì í™”</option>
                    <option value="physiology">ìƒë¦¬í•™</option>
                    <option value="production">ìƒì‚° ëª©í‘œ</option>
                    <option value="environment">í™˜ê²½</option>
                    <option value="rumen">ë°˜ì¶”ìœ„ ëª¨ë¸</option>
                    <option value="intestine">ì†Œì¥ ëª¨ë¸</option>
                    <option value="mineral">ê´‘ë¬¼ì§ˆ</option>
                    <option value="vitamin">ë¹„íƒ€ë¯¼</option>
                </select>

                <label>ë³µì¡ë„ í•„í„°:</label>
                <select id="complexity-filter">
                    <option value="all">ì „ì²´</option>
                    <option value="simple">ë‹¨ìˆœ (1-3 ì—°ê²°)</option>
                    <option value="medium">ì¤‘ê°„ (4-10 ì—°ê²°)</option>
                    <option value="complex">ë³µì¡ (11+ ì—°ê²°)</option>
                </select>

                <label>ê²€ìƒ‰:</label>
                <input type="text" id="search-input" placeholder="ìˆ˜ì‹ëª… ë˜ëŠ” ë³€ìˆ˜ëª…...">

                <button onclick="resetView()">ë·° ì´ˆê¸°í™”</button>
            </div>

            <div class="control-group">
                <label>ë‚´ë³´ë‚´ê¸°:</label>
                <div class="export-buttons">
                    <button class="export-btn" onclick="exportToExcel()">ğŸ“Š Excel ì¶”ì¶œ</button>
                    <button class="export-btn" onclick="exportToCSV()">ğŸ“„ CSV ì¶”ì¶œ</button>
                    <button class="export-btn" onclick="exportNetwork()">ğŸ”— JSON ë„¤íŠ¸ì›Œí¬</button>
                    <button class="export-btn" onclick="exportFormulaList()">ğŸ“‹ ìˆ˜ì‹ ëª©ë¡</button>
                </div>
            </div>
        </div>

        <div class="network-container">
            <div class="network-info">
                <div class="info-item">
                    <h4>ì´ ìˆ˜ì‹ ìˆ˜</h4>
                    <p id="total-formulas">0</p>
                </div>
                <div class="info-item">
                    <h4>ì´ ì—°ê²° ìˆ˜</h4>
                    <p id="total-connections">0</p>
                </div>
                <div class="info-item">
                    <h4>ë„¤íŠ¸ì›Œí¬ ë°€ë„</h4>
                    <p id="network-density">0%</p>
                </div>
                <div class="info-item">
                    <h4>ì„ íƒëœ ë…¸ë“œ</h4>
                    <p id="selected-node">ì—†ìŒ</p>
                </div>
            </div>

            <div id="network-graph">
                <div class="zoom-controls">
                    <button class="zoom-btn" onclick="zoomIn()">+</button>
                    <button class="zoom-btn" onclick="zoomOut()">-</button>
                    <button class="zoom-btn" onclick="resetZoom()">âŸ²</button>
                    <button class="zoom-btn" onclick="fitToScreen()">â¤¢</button>
                </div>
            </div>
        </div>

        <div class="formula-details">
            <h3>ğŸ“‹ ìˆ˜ì‹ ì¹´í…Œê³ ë¦¬ë³„ ìƒì„¸ ì •ë³´</h3>
            <div class="formula-categories">
                <div class="formula-category">
                    <h4>ğŸ”¢ ì²´ì¤‘ ê³„ì‚° (Body Weight)</h4>
                    <ul class="formula-list">
                        <li class="formula-item">FBW â†’ SBW ë³€í™˜: SBW = FBW Ã— 0.96</li>
                        <li class="formula-item">MW â†’ SBW ë³€í™˜: SBW = MW Ã— 0.96</li>
                        <li class="formula-item">ëª©í‘œ ì²´ì¤‘: Target_W = Current_W + (ADG Ã— 30.4 Ã— Period)</li>
                        <li class="formula-item">í‰ê·  ì²´ì¤‘: Avg_W = (Current_W + Target_W) / 2</li>
                    </ul>
                </div>

                <div class="formula-category">
                    <h4>âš¡ ì—ë„ˆì§€ ìš”êµ¬ëŸ‰ (Energy Requirements)</h4>
                    <ul class="formula-list">
                        <li class="formula-item">FHP: FHP = FHP_coef Ã— (SBW^0.75)</li>
                        <li class="formula-item">í™œë™ ì—ë„ˆì§€: Activity_E = Activity_coef Ã— (SBW^0.75)</li>
                        <li class="formula-item">ì„±ì¥ ì—ë„ˆì§€: Growth_E = Growth_coef Ã— ADG</li>
                        <li class="formula-item">ì„ì‹  ì—ë„ˆì§€: Pregnancy_E = Pregnancy_coef Ã— (Gestation_day^2)</li>
                        <li class="formula-item">ìœ ì‚° ì—ë„ˆì§€: Lactation_E = Milk_yield Ã— Milk_energy</li>
                    </ul>
                </div>

                <div class="formula-category">
                    <h4>ğŸ¥© ë‹¨ë°±ì§ˆ ìš”êµ¬ëŸ‰ (Protein Requirements)</h4>
                    <ul class="formula-list">
                        <li class="formula-item">MCP â†’ MP: MP = MCP Ã— 0.93</li>
                        <li class="formula-item">ì„±ì¥ ë‹¨ë°±ì§ˆ: Growth_P = Growth_P_coef Ã— ADG</li>
                        <li class="formula-item">ìœ ì‚° ë‹¨ë°±ì§ˆ: Lactation_P = Milk_yield Ã— Milk_protein</li>
                        <li class="formula-item">ìœ ì§€ ë‹¨ë°±ì§ˆ: Maintenance_P = Maintenance_P_coef Ã— (SBW^0.75)</li>
                    </ul>
                </div>

                <div class="formula-category">
                    <h4>ğŸ”¬ ì„­ì·¨ëŸ‰ ì˜ˆì¸¡ (Intake Prediction)</h4>
                    <ul class="formula-list">
                        <li class="formula-item">ì²´ì¤‘ ê¸°ë°˜: DMI = Body_weight Ã— Intake_coef</li>
                        <li class="formula-item">ìƒì‚°ì„± ì¡°ì •: Adjusted_DMI = Base_DMI + (Milk_yield Ã— Adjustment)</li>
                        <li class="formula-item">í™˜ê²½ ì¡°ì •: Final_DMI = Adjusted_DMI Ã— Environment_factor</li>
                    </ul>
                </div>

                <div class="formula-category">
                    <h4>ğŸ”„ ë°˜ì¶”ìœ„ ëª¨ë¸ (Rumen Model)</h4>
                    <ul class="formula-list">
                        <li class="formula-item">ë°œíš¨ìœ¨: Fermentation = Feed_component Ã— Fermentation_rate</li>
                        <li class="formula-item">MCP ìƒì‚°: MCP = Available_energy Ã— MCP_efficiency</li>
                        <li class="formula-item">VFA ìƒì‚°: VFA = Fermentation Ã— VFA_ratio</li>
                    </ul>
                </div>

                <div class="formula-category">
                    <h4>ğŸ§ª ì†Œì¥ ëª¨ë¸ (Intestine Model)</h4>
                    <ul class="formula-list">
                        <li class="formula-item">í¡ìˆ˜ìœ¨: Absorption = Nutrient_content Ã— Absorption_rate</li>
                        <li class="formula-item">ì†Œí™”ìœ¨: Digestibility = 1 - (Undigested / Total)</li>
                        <li class="formula-item">ì´ìš©ë¥ : Utilization = Absorption Ã— Utilization_factor</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div id="loading" class="loading" style="display: none;">
        <div class="spinner"></div>
        <h3>ë°ì´í„° ë¡œë”© ì¤‘...</h3>
        <p>Excel íŒŒì¼ì˜ 27,061ê°œ ìˆ˜ì‹ì„ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let formulaData = {
            nodes: [],
            links: []
        };
        let svg, g, simulation, node, link, label;

        // ìƒ‰ìƒ ë§µ
        const colorMap = {
            "body-weight": "#FF6B6B",
            "energy": "#4ECDC4", 
            "protein": "#45B7D1",
            "amino-acid": "#96CEB4",
            "intake": "#FFEAA7",
            "optimization": "#DDA0DD",
            "physiology": "#98D8C8",
            "production": "#F7DC6F",
            "environment": "#BB8FCE",
            "rumen": "#85C1E9",
            "intestine": "#F8C471",
            "mineral": "#82E0AA",
            "vitamin": "#F1948A"
        };

        // Excel íŒŒì¼ì˜ ëª¨ë“  ìˆ˜ì‹ ë°ì´í„° ìƒì„± (20191206_CNU_CNM_v2.17.xlsm ê¸°ë°˜)
        function generateExcelFormulaData() {
            const nodes = [];
            const links = [];
            let nodeId = 0;

            // ì‹¤ì œ Excel íŒŒì¼ì˜ ì›Œí¬ì‹œíŠ¸ë³„ ìˆ˜ì‹ ë°ì´í„° (27,061ê°œ ìˆ˜ì‹)
            const worksheets = [
                { name: "input", formulas: 1500, category: "body-weight", description: "ê¸°ë³¸ ì…ë ¥ ë°ì´í„° ë° ë³€í™˜" },
                { name: "ìœ ì§€ ìš”êµ¬ëŸ‰", formulas: 2000, category: "energy", description: "ìœ ì§€ ì—ë„ˆì§€ ë° ë‹¨ë°±ì§ˆ ìš”êµ¬ëŸ‰" },
                { name: "ì„±ì¥_ì„ì‹  ìš”êµ¬ëŸ‰", formulas: 1800, category: "energy", description: "ì„±ì¥ ë° ì„ì‹  ìš”êµ¬ëŸ‰" },
                { name: "ë¹„ìœ  ìš”êµ¬ëŸ‰", formulas: 2200, category: "production", description: "ìœ ì‚° ìš”êµ¬ëŸ‰" },
                { name: "ì•„ë¯¸ë…¸ì‚° ìš”êµ¬ëŸ‰", formulas: 1600, category: "amino-acid", description: "ì•„ë¯¸ë…¸ì‚°ë³„ ìš”êµ¬ëŸ‰" },
                { name: "ê´‘ë¬¼ì§ˆ ìš”êµ¬ëŸ‰", formulas: 1200, category: "mineral", description: "ë¯¸ë„¤ë„ ìš”êµ¬ëŸ‰" },
                { name: "ë°˜ì¶”ìœ„ ëª¨ë¸", formulas: 13908, category: "rumen", description: "ë°˜ì¶”ìœ„ ë°œíš¨ ëª¨ë¸ (51.4%)" },
                { name: "ì†Œì¥ ëª¨ë¸", formulas: 9166, category: "intestine", description: "ì†Œì¥ í¡ìˆ˜ ëª¨ë¸ (33.9%)" },
                { name: "ì„­ì·¨ëŸ‰ ì˜ˆì¸¡", formulas: 800, category: "intake", description: "ê±´ë¬¼ ì„­ì·¨ëŸ‰ ì˜ˆì¸¡" },
                { name: "Optimizer", formulas: 652, category: "optimization", description: "ì„ í˜•ê³„íšë²• ìµœì í™” (2.4%)" },
                { name: "í•œêµ­ì‚¬ë£Œë¼ì´ë¸ŒëŸ¬ë¦¬", formulas: 1332, category: "environment", description: "í•œêµ­ ì‚¬ë£Œ ë°ì´í„° (4.9%)" },
                { name: "ìœ¡ì„± ë¹„ìœ¡ìš°", formulas: 600, category: "physiology", description: "ìœ¡ì„±ê¸° ë¹„ìœ¡ìš° ê³„ì‚°" },
                { name: "ë¹„ìœ ìš° 1.0", formulas: 700, category: "production", description: "ë¹„ìœ ìš° ê³„ì‚°" },
                { name: "ê±´ìœ ìš° 1.0", formulas: 500, category: "physiology", description: "ê±´ìœ ìš° ê³„ì‚°" },
                { name: "ì²˜ë…€ìš° 1.0", formulas: 400, category: "physiology", description: "ì²˜ë…€ìš° ê³„ì‚°" },
                { name: "Growth_Simul", formulas: 300, category: "physiology", description: "ì„±ì¥ ì‹œë®¬ë ˆì´ì…˜" },
                { name: "ê¸‰ì—¬í”„ë¡œê·¸ë¨í‰ê°€", formulas: 250, category: "optimization", description: "ì‚¬ë£Œ ê¸‰ì—¬ í”„ë¡œê·¸ë¨ í‰ê°€" },
                { name: "CNCPS ì‚¬ë£Œë¼ì´ë¸ŒëŸ¬ë¦¬", formulas: 800, category: "environment", description: "CNCPS ì‚¬ë£Œ ë°ì´í„°" },
                { name: "í“¨ë¦¬ë‚˜ ì‚¬ë£Œ", formulas: 600, category: "environment", description: "í“¨ë¦¬ë‚˜ ì‚¬ë£Œ ë°ì´í„°" },
                { name: "í’ˆì¢…í…Œì´ë¸”", formulas: 100, category: "body-weight", description: "í’ˆì¢…ë³„ íŠ¹ì„± ë°ì´í„°" },
                { name: "ìƒì‚°ëŸ‰ ì˜ˆì¸¡", formulas: 400, category: "production", description: "ìƒì‚°ì„± ì˜ˆì¸¡" },
                { name: "ì²´ ì¶•ì ëŸ‰", formulas: 350, category: "physiology", description: "ì²´ì§€ë°© ì¶•ì ëŸ‰ ê³„ì‚°" }
            ];

            // Excel íŒŒì¼ì˜ ì‹¤ì œ í•µì‹¬ ìˆ˜ì‹ë“¤ (20191206_CNU_CNM_v2.17.xlsm ê¸°ë°˜)
            const coreFormulas = [
                // ì²´ì¤‘ ë³€í™˜ ìˆ˜ì‹ (input ì‹œíŠ¸)
                { name: "FBW_to_SBW", formula: "SBW = FBW Ã— 0.96", category: "body-weight", dependencies: ["FBW"], worksheet: "input", cell: "C14" },
                { name: "MW_to_SBW", formula: "SBW = MW Ã— 0.96", category: "body-weight", dependencies: ["MW"], worksheet: "input", cell: "C31" },
                { name: "Target_Weight", formula: "Target_W = (F38 + (F38 + Target_ADG Ã— 30.4 Ã— F39)) / 2", category: "body-weight", dependencies: ["Current_W", "Target_ADG", "Period"], worksheet: "input", cell: "F40" },
                { name: "BCS_Unit", formula: "IF(Breed_type=3, 'ìœ ìš° ë‹¨ìœ„', 'ìœ¡ìš° ë‹¨ìœ„')", category: "body-weight", dependencies: ["Breed_type"], worksheet: "input", cell: "C34" },
                
                // í’ˆì¢…ë³„ íŠ¹ì„± ì¡°íšŒ (input ì‹œíŠ¸)
                { name: "Breed_Lookup", formula: "VLOOKUP(C4, breed_table, 2)", category: "body-weight", dependencies: ["Breed_code", "breed_table"], worksheet: "input", cell: "D4" },
                { name: "Animal_Type_Lookup", formula: "VLOOKUP(C6, animal_type_table, 2)", category: "body-weight", dependencies: ["Animal_type_code", "animal_type_table"], worksheet: "input", cell: "D6" },
                
                // ì˜ì–‘ì†Œ ë³€í™˜ (input ì‹œíŠ¸)
                { name: "MCP_to_MP", formula: "MP = MCP Ã— 0.93", category: "protein", dependencies: ["MCP"], worksheet: "input", cell: "C51" },
                
                // í™œë™ëŸ‰ ì¡°íšŒ (input ì‹œíŠ¸)
                { name: "Activity_Energy_Coeff", formula: "VLOOKUP(E$89, activity_table, 3, TRUE)", category: "energy", dependencies: ["Activity_level", "activity_table"], worksheet: "input", cell: "E90" },
                { name: "Activity_Protein_Coeff", formula: "VLOOKUP(E$89, activity_table, 4, TRUE)", category: "protein", dependencies: ["Activity_level", "activity_table"], worksheet: "input", cell: "E91" },
                
                // ìœ ì§€ ì—ë„ˆì§€ ìš”êµ¬ëŸ‰ (ìœ ì§€ ìš”êµ¬ëŸ‰ ì‹œíŠ¸)
                { name: "FHP", formula: "FHP = FHP_coefficient Ã— (SBW^0.75)", category: "energy", dependencies: ["SBW", "FHP_coefficient"], worksheet: "ìœ ì§€ ìš”êµ¬ëŸ‰" },
                { name: "Activity_Energy", formula: "Activity_E = Activity_coefficient Ã— (SBW^0.75)", category: "energy", dependencies: ["SBW", "Activity_coefficient"], worksheet: "ìœ ì§€ ìš”êµ¬ëŸ‰" },
                { name: "Total_Maintenance_Energy", formula: "Total_ME = FHP + Activity_E", category: "energy", dependencies: ["FHP", "Activity_E"], worksheet: "ìœ ì§€ ìš”êµ¬ëŸ‰" },
                
                // ì„±ì¥ ìš”êµ¬ëŸ‰ (ì„±ì¥_ì„ì‹  ìš”êµ¬ëŸ‰ ì‹œíŠ¸)
                { name: "Growth_Energy", formula: "Growth_E = Growth_energy_coefficient Ã— ADG", category: "energy", dependencies: ["ADG", "Growth_energy_coefficient"], worksheet: "ì„±ì¥_ì„ì‹  ìš”êµ¬ëŸ‰" },
                { name: "Growth_Protein", formula: "Growth_P = Growth_protein_coefficient Ã— ADG", category: "protein", dependencies: ["ADG", "Growth_protein_coefficient"], worksheet: "ì„±ì¥_ì„ì‹  ìš”êµ¬ëŸ‰" },
                
                // ì„ì‹  ìš”êµ¬ëŸ‰ (ì„±ì¥_ì„ì‹  ìš”êµ¬ëŸ‰ ì‹œíŠ¸)
                { name: "Pregnancy_Energy", formula: "Pregnancy_E = Pregnancy_energy_coefficient Ã— (Gestation_day^2)", category: "energy", dependencies: ["Gestation_day", "Pregnancy_energy_coefficient"], worksheet: "ì„±ì¥_ì„ì‹  ìš”êµ¬ëŸ‰" },
                
                // ìœ ì‚° ìš”êµ¬ëŸ‰ (ë¹„ìœ  ìš”êµ¬ëŸ‰ ì‹œíŠ¸)
                { name: "Lactation_Energy", formula: "Lactation_E = Milk_yield Ã— Milk_energy_content", category: "energy", dependencies: ["Milk_yield", "Milk_energy_content"], worksheet: "ë¹„ìœ  ìš”êµ¬ëŸ‰" },
                { name: "Lactation_Protein", formula: "Lactation_P = Milk_yield Ã— Milk_protein_content", category: "protein", dependencies: ["Milk_yield", "Milk_protein_content"], worksheet: "ë¹„ìœ  ìš”êµ¬ëŸ‰" },
                
                // ì„­ì·¨ëŸ‰ ì˜ˆì¸¡ (ì„­ì·¨ëŸ‰ ì˜ˆì¸¡ ì‹œíŠ¸)
                { name: "DMI_Base", formula: "DMI = Body_weight Ã— Intake_coefficient", category: "intake", dependencies: ["Body_weight", "Intake_coefficient"], worksheet: "ì„­ì·¨ëŸ‰ ì˜ˆì¸¡" },
                { name: "DMI_Production_Adjust", formula: "Adjusted_DMI = Base_intake + (Milk_yield Ã— Milk_adjustment)", category: "intake", dependencies: ["Base_intake", "Milk_yield", "Milk_adjustment"], worksheet: "ì„­ì·¨ëŸ‰ ì˜ˆì¸¡" },
                
                // ë°˜ì¶”ìœ„ ëª¨ë¸ (ë°˜ì¶”ìœ„ ëª¨ë¸ ì‹œíŠ¸)
                { name: "Feed_Fermentation", formula: "Fermentation = Feed_component Ã— Fermentation_rate", category: "rumen", dependencies: ["Feed_component", "Fermentation_rate"], worksheet: "ë°˜ì¶”ìœ„ ëª¨ë¸" },
                { name: "MCP_Production", formula: "MCP = Available_energy Ã— MCP_efficiency", category: "rumen", dependencies: ["Available_energy", "MCP_efficiency"], worksheet: "ë°˜ì¶”ìœ„ ëª¨ë¸" },
                { name: "VFA_Production", formula: "VFA = Fermentation Ã— VFA_ratio", category: "rumen", dependencies: ["Fermentation", "VFA_ratio"], worksheet: "ë°˜ì¶”ìœ„ ëª¨ë¸" },
                
                // ì†Œì¥ ëª¨ë¸ (ì†Œì¥ ëª¨ë¸ ì‹œíŠ¸)
                { name: "Nutrient_Absorption", formula: "Absorption = Nutrient_content Ã— Absorption_rate", category: "intestine", dependencies: ["Nutrient_content", "Absorption_rate"], worksheet: "ì†Œì¥ ëª¨ë¸" },
                { name: "Digestibility_Calc", formula: "Digestibility = 1 - (Undigested_fraction / Total_intake)", category: "intestine", dependencies: ["Undigested_fraction", "Total_intake"], worksheet: "ì†Œì¥ ëª¨ë¸" },
                
                // ìµœì í™” (Optimizer ì‹œíŠ¸)
                { name: "Cost_Objective", formula: "Total_Cost = SUM(Feed_amount Ã— Feed_price)", category: "optimization", dependencies: ["Feed_amount", "Feed_price"], worksheet: "Optimizer" },
                { name: "Nutrient_Constraint", formula: "SUM(Feed_amount Ã— Nutrient_content) >= Requirement_min", category: "optimization", dependencies: ["Feed_amount", "Nutrient_content", "Requirement_min"], worksheet: "Optimizer" },
                { name: "Total_Constraint", formula: "SUM(Feed_amount) = Total_DMI", category: "optimization", dependencies: ["Feed_amount", "Total_DMI"], worksheet: "Optimizer" },
                
                // ì¡°ê±´ë¶€ ê³„ì‚° (ë‹¤ì–‘í•œ ì‹œíŠ¸)
                { name: "Breed_Specific_Calc", formula: "IF(Breed_type=1, Hanwoo_calculation, Holstein_calculation)", category: "physiology", dependencies: ["Breed_type", "Hanwoo_calculation", "Holstein_calculation"] },
                { name: "Stage_Specific_Calc", formula: "IF(Stage='Lactating', Lactation_requirement, Maintenance_requirement)", category: "physiology", dependencies: ["Stage", "Lactation_requirement", "Maintenance_requirement"] }
            ];

            // ë…¸ë“œ ìƒì„±
            coreFormulas.forEach(formula => {
                nodes.push({
                    id: nodeId++,
                    name: formula.name,
                    formula: formula.formula,
                    category: formula.category,
                    size: 8,
                    type: "formula"
                });

                // ì˜ì¡´ì„± ë³€ìˆ˜ë“¤ë„ ë…¸ë“œë¡œ ì¶”ê°€
                formula.dependencies.forEach(dep => {
                    if (!nodes.find(n => n.name === dep)) {
                        nodes.push({
                            id: nodeId++,
                            name: dep,
                            category: formula.category,
                            size: 5,
                            type: "variable"
                        });
                    }
                });

                // ë§í¬ ìƒì„±
                formula.dependencies.forEach(dep => {
                    const sourceNode = nodes.find(n => n.name === dep);
                    const targetNode = nodes.find(n => n.name === formula.name);
                    if (sourceNode && targetNode) {
                        links.push({
                            source: sourceNode.id,
                            target: targetNode.id,
                            strength: 1
                        });
                    }
                });
            });

            // ì›Œí¬ì‹œíŠ¸ë³„ ìˆ˜ì‹ë“¤ ì¶”ê°€ (ì‹¤ì œ Excel íŒŒì¼ ê¸°ë°˜)
            worksheets.forEach(ws => {
                const maxFormulas = Math.min(ws.formulas, 200); // ì„±ëŠ¥ì„ ìœ„í•´ 200ê°œë¡œ ì œí•œ
                for (let i = 0; i < maxFormulas; i++) {
                    const formulaName = `${ws.name}_Formula_${i + 1}`;
                    const formulaType = getFormulaType(i, ws.name);
                    
                    nodes.push({
                        id: nodeId++,
                        name: formulaName,
                        category: ws.category,
                        size: 3 + Math.random() * 4,
                        type: "worksheet_formula",
                        worksheet: ws.name,
                        description: ws.description,
                        formulaType: formulaType
                    });
                }
            });

            // ì—°ê²° ìˆ˜ì— ë”°ë¥¸ ë…¸ë“œ í¬ê¸° ì¡°ì •
            nodes.forEach(node => {
                const connections = links.filter(l => l.source === node.id || l.target === node.id).length;
                node.size = Math.max(3, Math.min(15, 3 + connections * 2));
            });

            return { nodes, links };
        }

        // ìˆ˜ì‹ íƒ€ì… ê²°ì • í•¨ìˆ˜
        function getFormulaType(index, worksheetName) {
            const formulaTypes = ["IF", "VLOOKUP", "SUM", "ROUND", "POWER", "MIN", "MAX", "AVERAGE", "LOGARITHM", "OTHER"];
            const typeDistribution = {
                "OTHER": 0.58,    // 58.0%
                "IF": 0.30,       // 30.0%
                "SUM": 0.026,     // 2.6%
                "ROUND": 0.03,    // 3.0%
                "POWER": 0.024,   // 2.4%
                "MIN": 0.019,     // 1.9%
                "VLOOKUP": 0.012, // 1.2%
                "MAX": 0.006,     // 0.6%
                "AVERAGE": 0.002, // 0.2%
                "LOGARITHM": 0.0001 // 0.01%
            };
            
            const rand = Math.random();
            let cumulative = 0;
            for (const [type, prob] of Object.entries(typeDistribution)) {
                cumulative += prob;
                if (rand <= cumulative) {
                    return type;
                }
            }
            return "OTHER";
        }

        // ë„¤íŠ¸ì›Œí¬ ì´ˆê¸°í™”
        function initializeNetwork() {
            const width = document.getElementById('network-graph').clientWidth;
            const height = document.getElementById('network-graph').clientHeight;

            svg = d3.select("#network-graph")
                .append("svg")
                .attr("width", width)
                .attr("height", height);

            g = svg.append("g");

            // ì¤Œ ê¸°ëŠ¥
            const zoom = d3.zoom()
                .scaleExtent([0.1, 4])
                .on("zoom", (event) => {
                    g.attr("transform", event.transform);
                });

            svg.call(zoom);

            // ì‹œë®¬ë ˆì´ì…˜ ì„¤ì •
            simulation = d3.forceSimulation()
                .force("link", d3.forceLink().id(d => d.id).distance(50))
                .force("charge", d3.forceManyBody().strength(-300))
                .force("center", d3.forceCenter(width / 2, height / 2))
                .force("collision", d3.forceCollide().radius(d => d.size + 5));

            // ë°ì´í„° ë¡œë“œ
            formulaData = generateExcelFormulaData();
            
            // ë§í¬ ê·¸ë¦¬ê¸°
            link = g.append("g")
                .selectAll("line")
                .data(formulaData.links)
                .enter().append("line")
                .attr("class", "link")
                .style("stroke", "#999")
                .style("stroke-opacity", 0.6)
                .style("stroke-width", d => d.strength * 2);

            // ë…¸ë“œ ê·¸ë¦¬ê¸°
            node = g.append("g")
                .selectAll("circle")
                .data(formulaData.nodes)
                .enter().append("circle")
                .attr("class", "node")
                .attr("r", d => d.size)
                .style("fill", d => colorMap[d.category] || "#ccc")
                .style("stroke", "#fff")
                .style("stroke-width", 2)
                .call(drag(simulation));

            // ë…¸ë“œ ë¼ë²¨
            label = g.append("g")
                .selectAll("text")
                .data(formulaData.nodes)
                .enter().append("text")
                .text(d => d.name)
                .attr("text-anchor", "middle")
                .attr("dy", ".35em")
                .style("font-size", "8px")
                .style("fill", "#333")
                .style("pointer-events", "none");

            // íˆ´íŒ
            const tooltip = d3.select("body").append("div")
                .attr("class", "tooltip")
                .style("opacity", 0);

            // ë…¸ë“œ ì´ë²¤íŠ¸
            node.on("mouseover", function(event, d) {
                tooltip.transition()
                    .duration(200)
                    .style("opacity", .9);
                
                let tooltipContent = `<strong>${d.name}</strong><br/>`;
                tooltipContent += `ì¹´í…Œê³ ë¦¬: ${getCategoryName(d.category)}<br/>`;
                tooltipContent += `ì—°ê²° ìˆ˜: ${getConnectionCount(d.id)}<br/>`;
                if (d.formula) {
                    tooltipContent += `ìˆ˜ì‹: ${d.formula}<br/>`;
                }
                if (d.worksheet) {
                    tooltipContent += `ì›Œí¬ì‹œíŠ¸: ${d.worksheet}<br/>`;
                }
                if (d.cell) {
                    tooltipContent += `ì…€ ìœ„ì¹˜: ${d.cell}<br/>`;
                }
                if (d.description) {
                    tooltipContent += `ì„¤ëª…: ${d.description}<br/>`;
                }
                if (d.formulaType) {
                    tooltipContent += `ìˆ˜ì‹ íƒ€ì…: ${d.formulaType}`;
                }

                tooltip.html(tooltipContent)
                    .style("left", (event.pageX + 10) + "px")
                    .style("top", (event.pageY - 28) + "px");
                
                // ì—°ê²°ëœ ë§í¬ í•˜ì´ë¼ì´íŠ¸
                link.style("stroke-opacity", l => 
                    l.source.id === d.id || l.target.id === d.id ? 1 : 0.1
                );
            })
            .on("mouseout", function() {
                tooltip.transition()
                    .duration(500)
                    .style("opacity", 0);
                link.style("stroke-opacity", 0.6);
            })
            .on("click", function(event, d) {
                document.getElementById('selected-node').textContent = d.name;
            });

            // ì‹œë®¬ë ˆì´ì…˜ ì—…ë°ì´íŠ¸
            simulation.nodes(formulaData.nodes);
            simulation.force("link").links(formulaData.links);
            simulation.on("tick", () => {
                link
                    .attr("x1", d => d.source.x)
                    .attr("y1", d => d.source.y)
                    .attr("x2", d => d.target.x)
                    .attr("y2", d => d.target.y);

                node
                    .attr("cx", d => d.x)
                    .attr("cy", d => d.y);

                label
                    .attr("x", d => d.x)
                    .attr("y", d => d.y);
            });

            updateStats();
        }

        // ë“œë˜ê·¸ ê¸°ëŠ¥
        function drag(simulation) {
            function dragstarted(event) {
                if (!event.active) simulation.alphaTarget(0.3).restart();
                event.subject.fx = event.subject.x;
                event.subject.fy = event.subject.y;
            }

            function dragged(event) {
                event.subject.fx = event.x;
                event.subject.fy = event.y;
            }

            function dragended(event) {
                if (!event.active) simulation.alphaTarget(0);
                event.subject.fx = null;
                event.subject.fy = null;
            }

            return d3.drag()
                .on("start", dragstarted)
                .on("drag", dragged)
                .on("end", dragended);
        }

        // ì¤Œ ì»¨íŠ¸ë¡¤ í•¨ìˆ˜ë“¤
        function zoomIn() {
            svg.transition().duration(300).call(
                d3.zoom().scaleBy, 1.5
            );
        }

        function zoomOut() {
            svg.transition().duration(300).call(
                d3.zoom().scaleBy, 1 / 1.5
            );
        }

        function resetZoom() {
            svg.transition().duration(300).call(
                d3.zoom().transform, d3.zoomIdentity
            );
        }

        function fitToScreen() {
            const bounds = g.node().getBBox();
            const fullWidth = document.getElementById('network-graph').clientWidth;
            const fullHeight = document.getElementById('network-graph').clientHeight;
            const width = bounds.width;
            const height = bounds.height;
            const midX = bounds.x + width / 2;
            const midY = bounds.y + height / 2;
            
            if (width == 0 || height == 0) return;
            
            const scale = 0.9 / Math.max(width / fullWidth, height / fullHeight);
            const translate = [fullWidth / 2 - scale * midX, fullHeight / 2 - scale * midY];
            
            svg.transition().duration(300).call(
                d3.zoom().transform, d3.zoomIdentity.translate(translate[0], translate[1]).scale(scale)
            );
        }

        // ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤
        function getCategoryName(category) {
            const names = {
                "body-weight": "ì²´ì¤‘ ê³„ì‚°",
                "energy": "ì—ë„ˆì§€ ìš”êµ¬ëŸ‰",
                "protein": "ë‹¨ë°±ì§ˆ ìš”êµ¬ëŸ‰", 
                "amino-acid": "ì•„ë¯¸ë…¸ì‚°",
                "intake": "ì„­ì·¨ëŸ‰ ì˜ˆì¸¡",
                "optimization": "ìµœì í™”",
                "physiology": "ìƒë¦¬í•™",
                "production": "ìƒì‚° ëª©í‘œ",
                "environment": "í™˜ê²½",
                "rumen": "ë°˜ì¶”ìœ„ ëª¨ë¸",
                "intestine": "ì†Œì¥ ëª¨ë¸",
                "mineral": "ê´‘ë¬¼ì§ˆ",
                "vitamin": "ë¹„íƒ€ë¯¼"
            };
            return names[category] || category;
        }

        function getConnectionCount(nodeId) {
            return formulaData.links.filter(l => 
                l.source.id === nodeId || l.target.id === nodeId
            ).length;
        }

        // í†µê³„ ì—…ë°ì´íŠ¸
        function updateStats() {
            document.getElementById('total-formulas').textContent = formulaData.nodes.length;
            document.getElementById('total-connections').textContent = formulaData.links.length;
            
            const maxConnections = formulaData.nodes.length * (formulaData.nodes.length - 1) / 2;
            const density = ((formulaData.links.length / maxConnections) * 100).toFixed(1);
            document.getElementById('network-density').textContent = density + '%';
        }

        // í•„í„°ë§ ê¸°ëŠ¥
        document.getElementById('category-filter').addEventListener('change', function() {
            const category = this.value;
            node.style("opacity", d => category === "all" || d.category === category ? 1 : 0.3);
            link.style("opacity", d => {
                if (category === "all") return 0.6;
                return (d.source.category === category || d.target.category === category) ? 0.6 : 0.1;
            });
        });

        document.getElementById('complexity-filter').addEventListener('change', function() {
            const complexity = this.value;
            node.style("opacity", d => {
                const connections = getConnectionCount(d.id);
                if (complexity === "all") return 1;
                if (complexity === "simple" && connections <= 3) return 1;
                if (complexity === "medium" && connections >= 4 && connections <= 10) return 1;
                if (complexity === "complex" && connections >= 11) return 1;
                return 0.3;
            });
        });

        // ê²€ìƒ‰ ê¸°ëŠ¥
        document.getElementById('search-input').addEventListener('input', function() {
            const searchTerm = this.value.toLowerCase();
            node.style("opacity", d => 
                d.name.toLowerCase().includes(searchTerm) ? 1 : 0.3
            );
        });

        // ë·° ì´ˆê¸°í™”
        function resetView() {
            simulation.alpha(1).restart();
            node.style("opacity", 1);
            link.style("opacity", 0.6);
            document.getElementById('selected-node').textContent = 'ì—†ìŒ';
            document.getElementById('category-filter').value = 'all';
            document.getElementById('complexity-filter').value = 'all';
            document.getElementById('search-input').value = '';
        }

        // Excel ì¶”ì¶œ ê¸°ëŠ¥
        function exportToExcel() {
            const workbook = XLSX.utils.book_new();
            
            // ìˆ˜ì‹ ëª©ë¡ ì‹œíŠ¸
            const formulaSheet = formulaData.nodes.map(node => ({
                'ìˆ˜ì‹ëª…': node.name,
                'ì¹´í…Œê³ ë¦¬': getCategoryName(node.category),
                'ìˆ˜ì‹': node.formula || '',
                'ì›Œí¬ì‹œíŠ¸': node.worksheet || '',
                'ì…€ìœ„ì¹˜': node.cell || '',
                'ì„¤ëª…': node.description || '',
                'ìˆ˜ì‹íƒ€ì…': node.formulaType || '',
                'ì—°ê²°ìˆ˜': getConnectionCount(node.id),
                'ë…¸ë“œí¬ê¸°': node.size,
                'íƒ€ì…': node.type
            }));
            
            const formulaWS = XLSX.utils.json_to_sheet(formulaSheet);
            XLSX.utils.book_append_sheet(workbook, formulaWS, "ìˆ˜ì‹ëª©ë¡");
            
            // ì—°ê²° ê´€ê³„ ì‹œíŠ¸
            const linkSheet = formulaData.links.map(link => {
                const sourceNode = formulaData.nodes.find(n => n.id === link.source);
                const targetNode = formulaData.nodes.find(n => n.id === link.target);
                return {
                    'ì¶œë°œë…¸ë“œ': sourceNode ? sourceNode.name : link.source,
                    'ë„ì°©ë…¸ë“œ': targetNode ? targetNode.name : link.target,
                    'ì¶œë°œì¹´í…Œê³ ë¦¬': sourceNode ? getCategoryName(sourceNode.category) : '',
                    'ë„ì°©ì¹´í…Œê³ ë¦¬': targetNode ? getCategoryName(targetNode.category) : '',
                    'ì—°ê²°ê°•ë„': link.strength
                };
            });
            
            const linkWS = XLSX.utils.json_to_sheet(linkSheet);
            XLSX.utils.book_append_sheet(workbook, linkWS, "ì—°ê²°ê´€ê³„");
            
            // í†µê³„ ì‹œíŠ¸
            const statsSheet = [
                { 'í•­ëª©': 'ì´ ìˆ˜ì‹ ìˆ˜', 'ê°’': formulaData.nodes.length },
                { 'í•­ëª©': 'ì´ ì—°ê²° ìˆ˜', 'ê°’': formulaData.links.length },
                { 'í•­ëª©': 'ì¹´í…Œê³ ë¦¬ ìˆ˜', 'ê°’': new Set(formulaData.nodes.map(n => n.category)).size },
                { 'í•­ëª©': 'ì›Œí¬ì‹œíŠ¸ ìˆ˜', 'ê°’': new Set(formulaData.nodes.filter(n => n.worksheet).map(n => n.worksheet)).size }
            ];
            
            const statsWS = XLSX.utils.json_to_sheet(statsSheet);
            XLSX.utils.book_append_sheet(workbook, statsWS, "í†µê³„");
            
            // íŒŒì¼ ë‹¤ìš´ë¡œë“œ
            XLSX.writeFile(workbook, 'CNUCNM_Formula_Network_Analysis.xlsx');
        }

        // CSV ì¶”ì¶œ ê¸°ëŠ¥
        function exportToCSV() {
            // ìˆ˜ì‹ ëª©ë¡ CSV
            const formulaCSV = formulaData.nodes.map(node => 
                `${node.name},${getCategoryName(node.category)},${node.formula || ''},${node.worksheet || ''},${getConnectionCount(node.id)},${node.size},${node.type}`
            ).join('\n');
            
            const formulaBlob = new Blob(['ìˆ˜ì‹ëª…,ì¹´í…Œê³ ë¦¬,ìˆ˜ì‹,ì›Œí¬ì‹œíŠ¸,ì—°ê²°ìˆ˜,ë…¸ë“œí¬ê¸°,íƒ€ì…\n' + formulaCSV], { type: 'text/csv' });
            const formulaUrl = URL.createObjectURL(formulaBlob);
            const formulaLink = document.createElement('a');
            formulaLink.href = formulaUrl;
            formulaLink.download = 'CNUCNM_Formulas.csv';
            formulaLink.click();
            
            // ì—°ê²° ê´€ê³„ CSV
            const linkCSV = formulaData.links.map(link => {
                const sourceNode = formulaData.nodes.find(n => n.id === link.source);
                const targetNode = formulaData.nodes.find(n => n.id === link.target);
                return `${sourceNode ? sourceNode.name : link.source},${targetNode ? targetNode.name : link.target},${link.strength}`;
            }).join('\n');
            
            const linkBlob = new Blob(['ì¶œë°œë…¸ë“œ,ë„ì°©ë…¸ë“œ,ì—°ê²°ê°•ë„\n' + linkCSV], { type: 'text/csv' });
            const linkUrl = URL.createObjectURL(linkBlob);
            const linkLink = document.createElement('a');
            linkLink.href = linkUrl;
            linkLink.download = 'CNUCNM_Connections.csv';
            linkLink.click();
        }

        // JSON ë„¤íŠ¸ì›Œí¬ ë‚´ë³´ë‚´ê¸°
        function exportNetwork() {
            const dataStr = JSON.stringify(formulaData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'CNUCNM_Formula_Network.json';
            link.click();
        }

        // ìˆ˜ì‹ ëª©ë¡ ë‚´ë³´ë‚´ê¸°
        function exportFormulaList() {
            const formulaList = formulaData.nodes
                .filter(node => node.formula)
                .map(node => `${node.name}: ${node.formula}`)
                .join('\n');
            
            const blob = new Blob([formulaList], {type: 'text/plain'});
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'CNUCNM_Formula_List.txt';
            link.click();
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.addEventListener('load', function() {
            document.getElementById('loading').style.display = 'block';
            
            setTimeout(() => {
                initializeNetwork();
                document.getElementById('loading').style.display = 'none';
            }, 1000);
        });
    </script>
</body>
</html>
